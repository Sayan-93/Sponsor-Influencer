<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="../static/Ad_Request.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.slim.js" integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
                <!-- Navbar -->
         {% if user_type == 'sponsor' %}
                
    <div class="bg-body-tertiary navbar-div">
      
        <ul class="nav justify-content-center">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/sponsor-page">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/sponsor-search">Search influencers</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/sponsor_ad_request_page">Ad requests</a>
          </li>
          <li>
            <form class="logout" action="/logout" method="post">
                <button class="btn btn-dark">Logout</button>
            </form>
          </li>
        </ul>
    </div>
            {% endif %}

        {% if user_type == 'influencer' %}
            <div class="bg-body-tertiary navbar-div">
        
                <ul class="nav justify-content-center">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="/influencer-page">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/influencer-search-campaign">Search campaigns</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/influencer_ad_request">Ad requests</a>
                </li>
                <li>
                    <form class="logout" action="/logout" method="post">
                        <button class="btn btn-dark">Logout</button>
                    </form>
                </li>
                </ul>
            </div>
        {% endif %}


    
    
    
    
    
        <!-- Ad request handler for sponsors -->

    {% if user_type == 'sponsor' %}

        <h3>Ad requests</h3>

        &nbsp;&nbsp;

    <table class="table">

        {% for campaign in campaign_list %}

            {% for ad_request in ad_request_list %}

                {% if campaign.id == ad_request.campaign_id %}

                    {% if not ad_request.flag %}

                        {% if ad_request.request_type == 'S' and ad_request.request_status == 'pending' %}

                            

                        <form action="/update_sponsor_ad_request" method="post">    
                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                        
                                            <div>
                                                <button type="submit" class="btn btn-primary">Unsend request</button>
                                                <input type="text" name="message" value="unsend request" hidden>
                                                <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                
                                                &nbsp;&nbsp;
                                                Ad request sent to {{ad_request.influencer_name}}
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>
                        </form>

                    {% elif ad_request.request_type == 'S' and ad_request.request_status == 'negotiation' and ad_request.Negotiation_type == 'S' %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                        
                                            
                                               &nbsp;&nbsp;

                                            <h5>Negotiation request sent. Awaiting {{ad_request.influencer_name}}'s response.</h5>    

                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>

                    {% elif ad_request.request_type == 'S' and ad_request.request_status == 'negotiation' and ad_request.Negotiation_type == 'I' %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                        
                                            
                                            <div>
                                                Negotiation request from <strong>{{ad_request.influencer_name}}</strong>
                                                <h5>Message: {{ad_request.Negotiation_message}}</h5>
                                            </div>

                                                &nbsp;&nbsp;

                                            <div class="accept-reject-buttons">    
                                                <form action="/update_sponsor_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Accept request</button>
                                                    <input type="text" name="message" value="request accepted" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="S" hidden>
                                                </form>
                                            
                                                &nbsp;&nbsp;

                                                <form action="/update_sponsor_ad_request" method="post">
                                                <button type="submit" class="btn btn-primary">Withdraw request</button>
                                                <input type="text" name="message" value="request rejected" hidden>
                                                <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                <input type="text" name="negotiation-type" value="S" hidden>
                                                </form>

                                                <form action="/update_sponsor_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Negotiate</button>
                                                    Amount: <input type="text" name="negotiation-amount">
                                                    Message: <input type="text" name="negotiation-message">
                                                    <input type="text" name="message" value="negotiation" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="S" hidden>
                                                    
                                                </form>
                                            </div>    

                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>

                    {% elif ad_request.request_type == 'S' and ad_request.request_status == 'accepted' and not ad_request.Negotiation_type %}
                        
                    <tr>
                        <div class="row cards">
                            <div class="col-sm-6 mb-3 mb-sm-0">
                            <div class="card text-bg-light mb-3">

                                <h5 class="card-header cards" id="cardTitle">{{campaign.title}}</h5>

                                <div class="card-body">
                                    
                                    <p class="card-text cards"><strong>Goal:</strong>&nbsp;{{campaign.description}}</p>
                                    <p class="card-text cards">Industry: {{campaign.industry}}</p>
                                    <p class="card-text cards">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                    
                                    <h5 class="accepted-text cards"><strong>{{ad_request.influencer_name}}</strong>&nbsp;accepted your offer</h5>

                                    <div class="accept-reject-buttons cards negotiation">    
                                        <form action="/update_sponsor_ad_request" method="post">
                                            <div class="cards"><button type="submit" class="btn btn-primary">&lt;-- Send to dashboard</button></div>
                                            <input type="text" name="message" value="dashboard" hidden>
                                            <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                        </form>
                                    </div>    

                                </div>
                            </div>
                            </div>
                        </div>
                    </tr>


                    {% elif ad_request.request_status == 'accepted' and ad_request.Negotiation_type == 'S' %}
                        
                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            
                                            <div><strong>You accepted {{ad_request.influencer_name}}</strong>'s offer</div>

                                                &nbsp;&nbsp;

                                            <div class="accept-reject-buttons">    
                                                <form action="/update_sponsor_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">&lt;-- Send to dashboard</button>
                                                    <input type="text" name="message" value="dashboard" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                </form>
                                            
                                                &nbsp;&nbsp;
                                            </div>    

                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>


                            {% elif ad_request.request_status == 'accepted' and ad_request.Negotiation_type == 'I' %}
                        
                                    <tr>
                                        <div class="row cards">
                                            <div class="col-sm-6 mb-3 mb-sm-0">
                                            <div class="card text-bg-light mb-3">
                
                                                <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>
                
                                                <div class="card-body">
                                                    
                                                    <p class="card-text">{{campaign.description}}</p>
                                                    <p class="card-text">Industry: {{campaign.industry}}</p>
                                                    <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                                    
                                                    <div><strong>{{ad_request.influencer_name}}</strong> accepted your offer</div>
                
                                                        &nbsp;&nbsp;
                
                                                    <div class="accept-reject-buttons">    
                                                        <form action="/update_sponsor_ad_request" method="post">
                                                            <button type="submit" class="btn btn-primary">&lt;-- Send to dashboard</button>
                                                            <input type="text" name="message" value="dashboard" hidden>
                                                            <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                        </form>
                                                    
                                                        &nbsp;&nbsp;
                                                    </div>    
                
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </tr>

                    {% elif ad_request.request_type == 'S' and ad_request.request_status == 'rejected' and not ad_request.Negotiation_type %}

                        <form action="/update_sponsor_ad_request" method="post">    
                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                        
                                            <div>
                                                <div class="rejected-text">
                                                <h5>{{ad_request.influencer_name}} rejected your offer.</h5>
                                                </div>
                                                &nbsp;&nbsp;

                                                <button type="submit" class="btn btn-primary">Delete request</button>
                                                <input type="text" name="message" value="unsend request" hidden>
                                                <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>
                        </form>


                        {% elif ad_request.request_status == 'rejected' and ad_request.Negotiation_type == 'S' %}

                                <form action="/update_sponsor_ad_request" method="post">    
                                    <tr>
                                        <div class="row cards">
                                            <div class="col-sm-6 mb-3 mb-sm-0">
                                            <div class="card text-bg-light mb-3">

                                                <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                                <div class="card-body">
                                                    
                                                    <p class="card-text">{{campaign.description}}</p>
                                                    <p class="card-text">Industry: {{campaign.industry}}</p>
                                                    <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                                
                                                    <div>
                                                        <div class="rejected-text">
                                                        <h5>You rejected {{ad_request.influencer_name}}'s offer.</h5>
                                                        </div>
                                                        &nbsp;&nbsp;

                                                        <button type="submit" class="btn btn-primary">Delete request</button>
                                                        <input type="text" name="message" value="unsend request" hidden>
                                                        <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </tr>
                                </form>


                                {% elif ad_request.request_status == 'rejected' and ad_request.Negotiation_type == 'I' %}

                                        <form action="/update_sponsor_ad_request" method="post">    
                                            <tr>
                                                <div class="row cards">
                                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                                    <div class="card text-bg-light mb-3">
                
                                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>
                
                                                        <div class="card-body">
                                                            
                                                            <p class="card-text">{{campaign.description}}</p>
                                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                                        
                                                            <div>
                                                                <div class="rejected-text">
                                                                <h5>{{ad_request.influencer_name}} rejected your offer.</h5>
                                                                </div>
                                                                &nbsp;&nbsp;
                
                                                                <button type="submit" class="btn btn-primary">Delete request</button>
                                                                <input type="text" name="message" value="unsend request" hidden>
                                                                <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                                
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                            </tr>
                                        </form>

                    {% elif ad_request.request_type == 'I' and ad_request.request_status == 'pending' and not ad_request.Negotiation_type %}

                        
                        <tr>
                            <div class="row cards">
                                <div class="col-sm-6 mb-3 mb-sm-0">
                                <div class="card text-bg-light mb-3">

                                    <h5 class="card-header cards" id="cardTitle">{{campaign.title}}</h5>

                                    <div class="card-body">
                                        
                                        <p class="card-text cards"><strong>Goal:&nbsp;</strong> {{campaign.description}}</p>
                                        <p class="card-text cards">Industry: {{campaign.industry}}</p>
                                        <p class="card-text cards">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                    
                                        
                                        <h5 class="card-text ad-request-message cards">Ad request from &nbsp;<strong>{{ad_request.influencer_name}}</strong></h5>

                                            &nbsp;&nbsp;

                                        <div class="accept-reject-buttons cards">    
                                            <form action="/update_sponsor_ad_request" method="post">
                                                <button type="submit" class="btn btn-primary">Accept request</button>
                                                <input type="text" name="message" value="request accepted" hidden>
                                                <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                <input type="text" name="negotiation-type" value="" hidden>
                                            </form>
                                        
                                            &nbsp;&nbsp;

                                            <form action="/update_sponsor_ad_request" method="post">
                                            <button type="submit" class="btn btn-primary">Reject request</button>
                                            <input type="text" name="message" value="request rejected" hidden>
                                            <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                            </form>
                                        </div>
                                        <div class="negotiation">
                                            <form action="/update_sponsor_ad_request" method="post">
                                                
                                                <p class="card-text cards">Amount:&nbsp; <input type="text" name="negotiation-amount"></p>
                                                <p class="card-text cards">Message:&nbsp; <input type="text" name="negotiation-message"></p>
                                                <div class="cards"><button type="submit" class="btn btn-primary ">Negotiate</button></div>
                                                <input type="text" name="message" value="negotiation" hidden>
                                                <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                <input type="text" name="negotiation-type" value="S" hidden>
                                            </form>
                                        </div>
                                    </div>    

                                    </div>
                                </div>
                                </div>
                            </div>
                        </tr>


                        {% elif ad_request.request_type == 'I' and ad_request.request_status == 'negotiation' and ad_request.Negotiation_type == 'S' %}

                                <tr>
                                    <div class="row cards">
                                        <div class="col-sm-6 mb-3 mb-sm-0">
                                        <div class="card text-bg-light mb-3">

                                            <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                            <div class="card-body">
                                                
                                                <p class="card-text cards">{{campaign.description}}</p>
                                                <p class="card-text cards">Industry: {{campaign.industry}}</p>
                                                <p class="card-text cards">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                                <h5 class="card-text cards">Your offer:&nbsp;{{ad_request.Negotiation_payment_amount}}</h5>
                                                
                                                <div cards>
                                                    <h5>Negotiation request sent. Awaiting {{ad_request.influencer_name}}'s response.</h5>
                                                </div>

                                            </div>    
                                        </div>
                                        </div>
                                    </div>
                                </tr>

                        {% elif ad_request.request_type == 'I' and ad_request.request_status == 'negotiation' and ad_request.Negotiation_type == 'I' %}
                    
                                <tr>
                                    <div class="row cards">
                                        <div class="col-sm-6 mb-3 mb-sm-0">
                                        <div class="card text-bg-light mb-3">

                                            <h5 class="card-header cards" id="cardTitle">{{campaign.title}}</h5>

                                            <div class="card-body">
                                                
                                                <p class="card-text cards">{{campaign.description}}</p>
                                                <p class="card-text cards">Industry: {{campaign.industry}}</p>
                                                <p class="card-text cards">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            
                                                
                                                <div class="cards">Negotiation request from <strong>{{ad_request.influencer_name}}</strong></div>
                                                <h5 cards>Message: {{ad_request.Negotiation_message}}</h5>
                                                

                                                    &nbsp;&nbsp;

                                                <div class="accept-reject-buttons">    
                                                    <form action="/update_sponsor_ad_request" method="post">
                                                        <button type="submit" class="btn btn-primary cards">Accept request</button>
                                                        <input type="text" name="message" value="request accepted" hidden>
                                                        <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                        <input type="text" name="negotiation-type" value="S" hidden>
                                                    </form>
                                                
                                                    &nbsp;&nbsp;

                                                    <form action="/update_sponsor_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary cards">Reject request</button>
                                                    <input type="text" name="message" value="request rejected" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="S" hidden>
                                                </form>
                                                </div>
                                                <div>
                                                    <form action="/update_sponsor_ad_request" method="post">
                                                        <button type="submit" class="btn btn-primary">Negotiate</button>
                                                        <div>Amount: <input type="text" name="negotiation-amount"></div>
                                                        <div>Message: <input type="text" name="negotiation-message"></div>
                                                        <input type="text" name="message" value="request rejected" hidden>
                                                        <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                        <input type="text" name="negotiation-type" value="S" hidden>
                                                    </form>
                                                </div>    

                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                </tr>

                    {% elif ad_request.request_type == 'I' and ad_request.request_status == 'accepted' and not ad_request.Negotiation_type %}

                    <tr>
                        <div class="row cards">
                            <div class="col-sm-6 mb-3 mb-sm-0">
                            <div class="card text-bg-light mb-3">

                                <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                <div class="card-body">
                                    
                                    <p class="card-text">{{campaign.description}}</p>
                                    <p class="card-text">Industry: {{campaign.industry}}</p>
                                    <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                
                                    
                                    <div>You accepted <strong>{{ad_request.influencer_name}}</strong>'s offer</div>

                                        &nbsp;&nbsp;

                                    <div class="accept-reject-buttons">    
                                        <form action="/update_sponsor_ad_request" method="post">
                                            <button type="submit" class="btn btn-primary">&lt;-- Send to dashboard</button>
                                            <input type="text" name="message" value="dashboard" hidden>
                                            <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                        </form>
                                    
                                        &nbsp;&nbsp;
                                    </div>    

                                </div>
                            </div>
                            </div>
                        </div>
                    </tr>

                    {% elif ad_request.request_type == 'I' and ad_request.request_status == 'rejected' %}

                    <tr>
                        <div class="row cards">
                            <div class="col-sm-6 mb-3 mb-sm-0">
                            <div class="card text-bg-light mb-3">

                                <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                <div class="card-body">
                                    
                                    <p class="card-text">{{campaign.description}}</p>
                                    <p class="card-text">Industry: {{campaign.industry}}</p>
                                    <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                
                                    
                                    <div class="rejected-text">
                                        <h5>You rejected <strong>{{ad_request.influencer_name}}</strong>'s offer</h5>
                                    </div>

                                        &nbsp;&nbsp;

                                    <div class="accept-reject-buttons">    
                                        <form action="/update_sponsor_ad_request" method="post">
                                            <button type="submit" class="btn btn-primary">Delete</button>
                                            <input type="text" name="message" value="deleted" hidden>
                                            <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                        </form>
                                    
                                        &nbsp;&nbsp;
                                    </div>    

                                </div>
                            </div>
                            </div>
                        </div>
                    </tr>

                        {% endif %}

                        {% else %}

                                <tr>
                                    <div class="row cards">
                                        <div class="col-sm-6 mb-3 mb-sm-0">
                                        <div class="card text-bg-light mb-3">

                                        <h5 class="card-header cards" id="cardTitle">{{campaign.title}}</h5>
                                        
                                    <div class="card-body">
                                        <p class="card-text cards">{{campaign.description}}</p>
                                        <p class="card-text cards">Industry: {{campaign.industry}}</p>
                                        <p class="card-text cards">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                    
                                        
                                        <div class="cards">Sponsor:<strong>&nbsp; {{ad_request.sponsor_name}}</strong> &nbsp;&nbsp; Influencer:<strong>&nbsp; {{ad_request.influencer_name}}</strong></div>
                                        <h5 class="cards negotiation rejected-text">FLAGGED</h5>
                                    </div>
                                                

                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                </tr>

                    {% endif %}

                {% endif %}

            {% endfor %}

        {% endfor %}

    </table>

                <!-- Ad request handler for influencers -->

    {% elif user_type == 'influencer' %}

        <h3>Ad requests</h3>

        

        &nbsp;&nbsp;

        <table class="table">
            <tbody>

        {% for campaign in campaign_list %}

            {% for ad_request in ad_request_list %}

                {% if campaign.id == ad_request.campaign_id %}

                    {% if not ad_request.flag %}

                        {% if ad_request.request_type == 'S' and ad_request.request_status == 'pending' %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header cards" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <h5 class="card-text cards">Ad request from &nbsp;<strong>{{ad_request.sponsor_name}}</strong></h5>
                                            <p class="card-text cards"><strong>Goal:</strong> &nbsp; {{campaign.description}}</p>
                                            <p class="card-text cards">Industry: {{campaign.industry}}</p>
                                            <p class="card-text cards">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text cards">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            &nbsp;
                                            <div class="accept-reject-buttons cards">
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Accept</button>
                                                    <input type="text" name="message" value="request accepted" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="" hidden>
                                                </form>
                                                &nbsp;&nbsp;
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Reject</button>
                                                    <input type="text" name="message" value="request rejected" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                </form>
                                            </div>
                                            <div class="negotiation">
                                                <form action="/update_influencer_ad_request" method="post">
                                                    
                                                    <p class="cards">Amount: <input type="text" name="negotiation-amount"></p>
                                                    <p class="cards">Message: <input type="text" name="negotiation-message"></p>
                                                    <div class="cards"><button type="submit" class="btn btn-primary">Negotiate</button></div>
                                                    <input type="text" name="message" value="negotiation" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="I" hidden>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>


                    {% elif ad_request.request_type == 'S' and ad_request.request_status == 'negotiation' and ad_request.Negotiation_type == 'I' %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">Ad request from <strong>{{ad_request.sponsor_name}}</strong></p>
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            &nbsp;
                                            <div class="accept-reject-buttons">
                                                <h5>Request sent. Awaiting response from {{ad_request.sponsor_name}}</h5>
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>

                    {% elif ad_request.request_type == 'S' and ad_request.request_status == 'negotiation' and ad_request.Negotiation_type == 'S' %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">Ad request from <strong>{{ad_request.sponsor_name}}</strong></p>
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            &nbsp;
                                            <div class="accept-reject-buttons">
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Accept</button>
                                                    <input type="text" name="message" value="request accepted" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="I">
                                                </form>
                                               
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Reject</button>
                                                    <input type="text" name="message" value="request rejected" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="I">
                                                </form>
                                            </div>
                                            <div>
                                                <h5>Message from {{ad_request.sponsor_name}}: {{ad_request.Negotiation_message}}</h5>
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Negotiate</button>
                                                    Amount: <input type="text" name="negotiation-amount">
                                                    Message: <input type="text" name="negotiation-message">
                                                    <input type="text" name="message" value="negotiation" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="I" hidden>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>

                    {% elif ad_request.request_type == 'S' and ad_request.request_status == 'accepted' and not ad_request.Negotiation_type %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header cards" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            
                                            <p class="card-text cards"><strong>Goal:</strong>&nbsp;{{campaign.description}}</p>
                                            <p class="card-text cards">Industry: {{campaign.industry}}</p>
                                            <p class="card-text cards">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text cards">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            <h5 class="card-text accepted-text cards">You accepted&nbsp;<strong>{{ad_request.sponsor_name}}</strong>'s ad request</h5>
                                            <div class="negotiation">
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <div class="cards"><button type="submit" class="btn btn-primary">&lt;-- Send to dashboard</button></div>
                                                    <input type="text" name="message" value="dashboard" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                </form>
                                                
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>


                            {% elif ad_request.request_status == 'accepted' and ad_request.Negotiation_type == 'S' %}

                                    <tr>
                                        <div class="row cards">
                                            <div class="col-sm-6 mb-3 mb-sm-0">
                                            <div class="card text-bg-light mb-3">

                                                <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                                <div class="card-body">
                                                    
                                                    <p class="card-text">{{campaign.description}}</p>
                                                    <p class="card-text">Industry: {{campaign.industry}}</p>
                                                    <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                                    <h5 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h5>
                                                    <p class="card-text"><strong>{{ad_request.sponsor_name}}</strong> accepted your offer</p>
                                                    <div>
                                                        <form action="/update_influencer_ad_request" method="post">
                                                            <button type="submit" class="btn btn-primary">&lt;-- Send to dashboard</button>
                                                            <input type="text" name="message" value="dashboard" hidden>
                                                            <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                        </form>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </tr>


                                    {% elif ad_request.request_status == 'accepted' and ad_request.Negotiation_type == 'I' %}

                                            <tr>
                                                <div class="row cards">
                                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                                    <div class="card text-bg-light mb-3">

                                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                                        <div class="card-body">
                                                            
                                                            <p class="card-text">{{campaign.description}}</p>
                                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                                            <h5 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h5>
                                                            <p class="card-text"><strong>You accepted {{ad_request.sponsor_name}}</strong>'s offer</p>
                                                            <div>
                                                                <form action="/update_influencer_ad_request" method="post">
                                                                    <button type="submit" class="btn btn-primary">&lt;-- Send to dashboard</button>
                                                                    <input type="text" name="message" value="dashboard" hidden>
                                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                                </form>
                                                                
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </div>
                                                </div>
                                            </tr>
                                    

                    {% elif ad_request.request_type == 'S' and ad_request.request_status == 'rejected' and not ad_request.Negotiation_type %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            &nbsp;
                                            <h5 class="card-text rejected-text">You rejected {{ad_request.sponsor_name}}'s offer.</strong></h5>
                                            
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>


                            {% elif ad_request.request_status == 'rejected' and ad_request.Negotiation_type == 'S' %}

                                    <tr>
                                        <div class="row cards">
                                            <div class="col-sm-6 mb-3 mb-sm-0">
                                            <div class="card text-bg-light mb-3">

                                                <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                                <div class="card-body">
                                                    
                                                    
                                                    <p class="card-text">{{campaign.description}}</p>
                                                    <p class="card-text">Industry: {{campaign.industry}}</p>
                                                    <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                                    <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                                    &nbsp;
                                                    <h5 class="card-text rejected-text">{{ad_request.sponsor_name}}&nbsp; rejected your offer.</strong></h5>
                                                    
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </tr>


                            {% elif ad_request.request_status == 'rejected' and ad_request.Negotiation_type == 'I' %}

                                    <tr>
                                        <div class="row cards">
                                            <div class="col-sm-6 mb-3 mb-sm-0">
                                            <div class="card text-bg-light mb-3">

                                                <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                                <div class="card-body">
                                                    
                                                    
                                                    <p class="card-text">{{campaign.description}}</p>
                                                    <p class="card-text">Industry: {{campaign.industry}}</p>
                                                    <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                                    <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                                    &nbsp;
                                                    <h5 class="card-text rejected-text">You rejected {{ad_request.sponsor_name}}'s offer.</strong></h5>
                                                    
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                    </tr>

                    {% elif ad_request.request_type == 'I' and ad_request.request_status == 'pending' %}
                            
                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            &nbsp;
                                            <form action="/update_influencer_ad_request" method="post">
                                            <div>
                                                <button type="submit" class="btn btn-primary">Unsend request</button>
                                                <input type="text" name="message" value="unsend request" hidden>
                                                <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                &nbsp;&nbsp;
                                                Ad request sent to {{ad_request.sponsor_name}}
                                            </div>
                                            </form>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>
                        

                    
                    {% elif ad_request.request_type == 'I' and ad_request.request_status == 'negotiation' and ad_request.Negotiation_type == 'S' %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            <p class="card-text">Ad request from <strong>{{ad_request.sponsor_name}}</strong></p>
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            &nbsp;
                                            <div class="accept-reject-buttons">
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Accept</button>
                                                    <input type="text" name="message" value="request accepted" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="I" hidden>
                                                </form>
                                                &nbsp;&nbsp;
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Reject</button>
                                                    <input type="text" name="message" value="request rejected" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="I" hidden>
                                                </form>
                                                
                                                </div>
                                                <div>
                                                <h5>Message from {{ad_request.sponsor_name}}: {{ad_request.Negotiation_message}}</h5>
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">Negotiate</button>
                                                    Amount: <input type="text" name="negotiation-payment-amount">
                                                    Message: <input type="text" name="negotiation-message">
                                                    <input type="text" name="message" value="negotiation" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                    <input type="text" name="negotiation-type" value="I" hidden>
                                                </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>

                    {% elif ad_request.request_type == 'I' and ad_request.request_status == 'negotiation' and ad_request.Negotiation_type == 'I' %}

                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                           
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h5 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h5>
                                            
                                            
                                           <h5 class="card-text">Request sent. Awaiting response from {{ad_request.sponsor_name}}</h5>
                                            
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>

                    {% elif ad_request.request_type == 'I' and ad_request.request_status == 'accepted' and not ad_request.Negotiation_type %}
                        
                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            &nbsp;
                                            <p class="card-text"><p class="card-text">Your request has been accepted by <strong>{{ad_request.sponsor_name}}</strong></p></p>
                                            <div>
                                                <form action="/update_influencer_ad_request" method="post">
                                                    <button type="submit" class="btn btn-primary">&nbsp;-- Send to dahsboard</button>
                                                    <input type="text" name="message" value="dashboard" hidden>
                                                    <input type="text" name="ad-request-id" value="{{ad_request.id}}" hidden>
                                                </form>
                                                
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>

                    {% elif ad_request.request_type == 'I' and ad_request.request_status == 'rejected' %}
                
                            <tr>
                                <div class="row cards">
                                    <div class="col-sm-6 mb-3 mb-sm-0">
                                    <div class="card text-bg-light mb-3">

                                        <h5 class="card-header" id="cardTitle">{{campaign.title}}</h5>

                                        <div class="card-body">
                                            
                                            
                                            <p class="card-text">{{campaign.description}}</p>
                                            <p class="card-text">Industry: {{campaign.industry}}</p>
                                            <p class="card-text">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                            <h4 class="card-text">Payment amount: {{ad_request.Negotiation_payment_amount}}</h4>
                                            &nbsp;
                                            <h5 class="card-text rejected-text"><strong>{{ad_request.sponsor_name}}</strong> has rejected your request.</h5>
                                            
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </tr>

                        

                        {% endif %}

                        {% else %}

                                <tr>
                                    <div class="row cards">
                                        <div class="col-sm-6 mb-3 mb-sm-0">
                                        <div class="card text-bg-light mb-3">

                                        <h5 class="card-header cards" id="cardTitle">{{campaign.title}}</h5>
                                        
                                    <div class="card-body">
                                        <p class="card-text cards">{{campaign.description}}</p>
                                        <p class="card-text cards">Industry: {{campaign.industry}}</p>
                                        <p class="card-text cards">Created: {{campaign.start_date.date()}} &nbsp;&nbsp;  Ends at: {{campaign.end_date.date()}}</p>
                                    
                                        
                                        <div class="cards">Sponsor:<strong>&nbsp; {{ad_request.sponsor_name}}</strong> &nbsp;&nbsp; Influencer:<strong>&nbsp; {{ad_request.influencer_name}}</strong></div>
                                        <h5 class="cards negotiation rejected-text">FLAGGED</h5>
                                    </div>
                                                

                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                </tr>
                    {% endif %}

                {% endif %}

            {% endfor %}

        {% endfor %}

    {% endif %}
        </tbody>
    </table>
</body>
</html>